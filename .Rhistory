if(is.null(rr2[[1]])) { ## EM algorithm did not converge
message("didn't converage")
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
cells_1 <- names(rr2$classification)[rr2$classification==1]
cells_2 <- names(rr2$classification)[rr2$classification==2]
cutoff_tmp <- mean(c(min(data[cells_2]), max(data[cells_1])))
cutoffs <- c(cutoffs,cutoff_tmp)
symbol <- names(control)[2]
A1 <- density(data[cells_1],adjust=2)
max.y_tmp <- max(A1$y)
A <- density(data)
max.y <- max(A$y)
par(lwd = 4)
foo <- hist(data,breaks = 50,freq = F,axes = F, ylab = NULL, xlab = NULL,col = "lightgray", main = NULL,cex=2, xaxt='n',ann=FALSE)
max.y <- max(foo$density)
#  axis(side = 2, lwd = 4,ann=FALSE)
title(main = symbol,col.main="blue",cex.main=4)
max.y <- max(foo$density)
A1 <- density(data[cells_1],adjust=2)
lines(A1$x,scales::rescale(A1$y, to=c(0,max.y)),col="indianred4",lwd=4)
A2 <- density(data[cells_2],adjust=2)
max.y <- max(A$y)
lines(A2$x,scales::rescale(A2$y, to=c(0,max.y)), col="mediumorchid4",lwd=4)
abline(v=cutoff_tmp, col=c("red"), lty=2)
data <- RNA_CTRPv2_All_CCLE[BC_cells,paste(control[2],"_at",sep = "")][!is.na(RNA_CTRPv2_All_CCLE[BC_cells,paste(control[2],"_at",sep = ""))]
if(var(data)==0){
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
rr2 <- mclust::Mclust(data = data, modelNames="V", G=2)
if(is.null(rr2[[1]])) { ## EM algorithm did not converge
message("didn't converage")
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
cells_1 <- names(rr2$classification)[rr2$classification==1]
cells_2 <- names(rr2$classification)[rr2$classification==2]
cutoff_tmp <- mean(c(min(data[cells_2]), max(data[cells_1])))
cutoffs <- c(cutoffs,cutoff_tmp)
symbol <- names(control)[2]
A1 <- density(data[cells_1],adjust=2)
max.y_tmp <- max(A1$y)
A <- density(data)
max.y <- max(A$y)
par(lwd = 4)
foo <- hist(data,breaks = 50,freq = F,axes = F, ylab = NULL, xlab = NULL,col = "lightgray", main = NULL,cex=2, xaxt='n',ann=FALSE)
max.y <- max(foo$density)
#  axis(side = 2, lwd = 4,ann=FALSE)
title(main = symbol,col.main="blue",cex.main=4)
max.y <- max(foo$density)
A1 <- density(data[cells_1],adjust=2)
lines(A1$x,scales::rescale(A1$y, to=c(0,max.y)),col="indianred4",lwd=4)
A2 <- density(data[cells_2],adjust=2)
max.y <- max(A$y)
lines(A2$x,scales::rescale(A2$y, to=c(0,max.y)), col="mediumorchid4",lwd=4)
abline(v=cutoff_tmp, col=c("red"), lty=2)
data <- RNA_CTRPv2_All_CCLE[BC_cells,paste(control[2],"_at",sep = "")][!is.na(RNA_CTRPv2_All_CCLE[BC_cells,paste(control[2],"_at",sep = ""))]
if(var(data)==0){
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
rr2 <- mclust::Mclust(data = data, modelNames="V", G=2)
if(is.null(rr2[[1]])) { ## EM algorithm did not converge
message("didn't converage")
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
cells_1 <- names(rr2$classification)[rr2$classification==1]
cells_2 <- names(rr2$classification)[rr2$classification==2]
cutoff_tmp <- mean(c(min(data[cells_2]), max(data[cells_1])))
cutoffs <- c(cutoffs,cutoff_tmp)
symbol <- names(control)[2]
A1 <- density(data[cells_1],adjust=2)
max.y_tmp <- max(A1$y)
A <- density(data)
max.y <- max(A$y)
par(lwd = 4)
foo <- hist(data,breaks = 50,freq = F,axes = F, ylab = NULL, xlab = NULL,col = "lightgray", main = NULL,cex=2, xaxt='n',ann=FALSE)
max.y <- max(foo$density)
#  axis(side = 2, lwd = 4,ann=FALSE)
title(main = symbol,col.main="blue",cex.main=4)
max.y <- max(foo$density)
A1 <- density(data[cells_1],adjust=2)
lines(A1$x,scales::rescale(A1$y, to=c(0,max.y)),col="indianred4",lwd=4)
A2 <- density(data[cells_2],adjust=2)
max.y <- max(A$y)
lines(A2$x,scales::rescale(A2$y, to=c(0,max.y)), col="mediumorchid4",lwd=4)
abline(v=cutoff_tmp, col=c("red"), lty=2)
paste
data <- RNA_CTRPv2_All_CCLE[BC_cells,paste(control[2],"_at",sep = "")][!is.na(RNA_CTRPv2_All_CCLE[BC_cells,paste(control[2],"_at",sep = ""))]
data <- RNA_CTRPv2_All_CCLE[BC_cells,paste(control[2],"_at",sep = "")][!is.na(RNA_CTRPv2_All_CCLE[BC_cells,paste(control[2],"_at",sep = "")])]
if(var(data)==0){
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
rr2 <- mclust::Mclust(data = data, modelNames="V", G=2)
if(is.null(rr2[[1]])) { ## EM algorithm did not converge
message("didn't converage")
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
cells_1 <- names(rr2$classification)[rr2$classification==1]
cells_2 <- names(rr2$classification)[rr2$classification==2]
cutoff_tmp <- mean(c(min(data[cells_2]), max(data[cells_1])))
cutoffs <- c(cutoffs,cutoff_tmp)
symbol <- names(control)[2]
A1 <- density(data[cells_1],adjust=2)
max.y_tmp <- max(A1$y)
A <- density(data)
max.y <- max(A$y)
par(lwd = 4)
foo <- hist(data,breaks = 50,freq = F,axes = F, ylab = NULL, xlab = NULL,col = "lightgray", main = NULL,cex=2, xaxt='n',ann=FALSE)
max.y <- max(foo$density)
#  axis(side = 2, lwd = 4,ann=FALSE)
title(main = symbol,col.main="blue",cex.main=4)
max.y <- max(foo$density)
A1 <- density(data[cells_1],adjust=2)
lines(A1$x,scales::rescale(A1$y, to=c(0,max.y)),col="indianred4",lwd=4)
A2 <- density(data[cells_2],adjust=2)
max.y <- max(A$y)
lines(A2$x,scales::rescale(A2$y, to=c(0,max.y)), col="mediumorchid4",lwd=4)
abline(v=cutoff_tmp, col=c("red"), lty=2)
BC_cells <- rownames(CTRPv2.CCLE@cell)[CTRPv2.CCLE@cell$tissueid=="breast"]
BC_cells <- intersect(BC_cells,rownames(RNAseq_CTRPv2_All_CCLE))
data <- RNAseq_CTRPv2_All_CCLE[BC_cells,control[2]][!is.na(RNAseq_CTRPv2_All_CCLE[BC_cells,control[2]])]
if(var(data)==0){
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
rr2 <- mclust::Mclust(data = data, modelNames="V", G=2)
if(is.null(rr2[[1]])) { ## EM algorithm did not converge
message("didn't converage")
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
cells_1 <- names(rr2$classification)[rr2$classification==1]
cells_2 <- names(rr2$classification)[rr2$classification==2]
cutoff_tmp <- mean(c(min(data[cells_2]), max(data[cells_1])))
cutoffs <- c(cutoffs,cutoff_tmp)
symbol <- names(control)[2]
A1 <- density(data[cells_1],adjust=2)
max.y_tmp <- max(A1$y)
A <- density(data)
max.y <- max(A$y)
par(lwd = 4)
foo <- hist(data,breaks = 50,freq = F,axes = F, ylab = NULL, xlab = NULL,col = "lightgray", main = NULL,cex=2, xaxt='n',ann=FALSE)
max.y <- max(foo$density)
#  axis(side = 2, lwd = 4,ann=FALSE)
title(main = symbol,col.main="blue",cex.main=4)
max.y <- max(foo$density)
A1 <- density(data[cells_1],adjust=2)
lines(A1$x,scales::rescale(A1$y, to=c(0,max.y)),col="indianred4",lwd=4)
A2 <- density(data[cells_2],adjust=2)
max.y <- max(A$y)
lines(A2$x,scales::rescale(A2$y, to=c(0,max.y)), col="mediumorchid4",lwd=4)
abline(v=cutoff_tmp, col=c("red"), lty=2)
lines(A2$x,scales::rescale(A2$y, to=c(0,2*max.y)), col="mediumorchid4",lwd=4)
BC_cells <- rownames(CTRPv2.CCLE@cell)[CTRPv2.CCLE@cell$tissueid=="breast"]
BC_cells <- intersect(BC_cells,rownames(RNAseq_CTRPv2_All_CCLE))
data <- RNAseq_CTRPv2_All_CCLE[BC_cells,control[2]][!is.na(RNAseq_CTRPv2_All_CCLE[BC_cells,control[2]])]
if(var(data)==0){
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
rr2 <- mclust::Mclust(data = data, modelNames="V", G=2)
if(is.null(rr2[[1]])) { ## EM algorithm did not converge
message("didn't converage")
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
cells_1 <- names(rr2$classification)[rr2$classification==1]
cells_2 <- names(rr2$classification)[rr2$classification==2]
cutoff_tmp <- mean(c(min(data[cells_2]), max(data[cells_1])))
cutoffs <- c(cutoffs,cutoff_tmp)
symbol <- names(control)[2]
A1 <- density(data[cells_1],adjust=2)
max.y_tmp <- max(A1$y)
A <- density(data)
max.y <- max(A$y)
par(lwd = 4)
foo <- hist(data,breaks = 50,freq = F,axes = F, ylab = NULL, xlab = NULL,col = "lightgray", main = NULL,cex=2, xaxt='n',ann=FALSE)
max.y <- max(foo$density)
#  axis(side = 2, lwd = 4,ann=FALSE)
title(main = symbol,col.main="blue",cex.main=4)
max.y <- max(foo$density)
A1 <- density(data[cells_1],adjust=2)
lines(A1$x,scales::rescale(A1$y, to=c(0,max.y)),col="indianred4",lwd=4)
A2 <- density(data[cells_2],adjust=2)
max.y <- max(A$y)
lines(A2$x,scales::rescale(A2$y, to=c(0,2*max.y)), col="mediumorchid4",lwd=4)
abline(v=cutoff_tmp, col=c("red"), lty=2)
hist(RNAseq_CTRPv2_All_CCLE[,"ENSG00000141736"])
hist(RNAseq_CTRPv2_All_CCLE[,"ENSG00000011422"])
BC_cells <- rownames(CTRPv2.CCLE@cell)[CTRPv2.CCLE@cell$tissueid=="breast"]
BC_cells <- intersect(BC_cells,rownames(RNAseq_CTRPv2_All_CCLE))
hist(RNAseq_CTRPv2_All_CCLE[BC_cells,"ENSG00000141736"])
hist(RNAseq_CTRPv2_All_CCLE[BC_cells,"ENSG00000011422"])
hist(RNAseq_CTRPv2_All_CCLE[BC_cells,"ENSG00000115415 "])
hist(RNAseq_CTRPv2_All_CCLE[BC_cells,"ENSG00000115415"])
hist(RNAseq_CTRPv2_All_CCLE[,"ENSG00000115415"])
hist(RNAseq_CTRPv2_All_CCLE[,control[2]])
hist(RNAseq_CTRPv2_All_CCLE[BC_cells,control[2]])
hist(RNAseq_CTRPv2_All_CCLE[,control[2]],breaks = 150)
hist(RNAseq_CTRPv2_All_CCLE[BC_cells,control[2]], breaks = 150)
load("~/Projects/PSets/PSets/GRAY.RData")
GRAY
GRAY@molecularProfiles
RNAseq_CTRPv2_All_CCLE <- t(exprs(summarizeMolecularProfiles(GRAY,mDataType = "rnaseq",fill.missing = F)))
hist(RNAseq_CTRPv2_All_CCLE[,control[2]],breaks = 150)
hist(RNAseq_CTRPv2_All_CCLE[,control[2]])
hist(RNAseq_CTRPv2_All_CCLE[,control[2]],breaks = 15)
hist(RNAseq_CTRPv2_All_CCLE[,control[2]],breaks = 30)
load("~/Projects/PSets/PSets/GDSC1000.RData")
RNAseq_CTRPv2_All_CCLE <- t(exprs(summarizeMolecularProfiles(GDSC1000,mDataType = "rna",fill.missing = F)))
hist(RNAseq_CTRPv2_All_CCLE[,paste(control[2]],"_at",sep=""),breaks = 30)
hist(RNAseq_CTRPv2_All_CCLE[,paste(control[2],"_at",sep="")],breaks = 30)
RNAseq_CTRPv2_All_CCLE <- t(exprs(summarizeMolecularProfiles(CTRPv2.CCLE,mDataType = "rnaseq",fill.missing = F)))
load("~/Projects/PSets/PSets/UHNBreast.RData")
RNAseq_CTRPv2_All_CCLE <- t(exprs(summarizeMolecularProfiles(UHNBreast,mDataType = "rnaseq",fill.missing = F)))
hist(RNAseq_CTRPv2_All_CCLE[,control[2]],breaks = 30)
hist(RNAseq_CTRPv2_All_CCLE[,"ENSG00000196735 ",breaks = 30)
hist(RNAseq_CTRPv2_All_CCLE[,"ENSG00000196735"],breaks = 30)
RNAseq_CTRPv2_All_CCLE <- t(exprs(summarizeMolecularProfiles(CTRPv2.CCLE,mDataType = "rnaseq",fill.missing = F)))
data <- RNAseq_CTRPv2_All_CCLE[,control[2]][!is.na(RNAseq_CTRPv2_All_CCLE[,control[2]])]
if(var(data)==0){
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
rr2 <- mclust::Mclust(data = data, modelNames="V", G=2)
if(is.null(rr2[[1]])) { ## EM algorithm did not converge
message("didn't converage")
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
cells_1 <- names(rr2$classification)[rr2$classification==1]
cells_2 <- names(rr2$classification)[rr2$classification==2]
cutoff_tmp <- mean(c(min(data[cells_2]), max(data[cells_1])))
cutoffs <- c(cutoffs,cutoff_tmp)
symbol <- names(control)[2]
A1 <- density(data[cells_1],adjust=2)
max.y_tmp <- max(A1$y)
A <- density(data)
max.y <- max(A$y)
par(lwd = 4)
foo <- hist(data,breaks = 50,freq = F,axes = F, ylab = NULL, xlab = NULL,col = "lightgray", main = NULL,cex=2, xaxt='n',ann=FALSE)
max.y <- max(foo$density)
#  axis(side = 2, lwd = 4,ann=FALSE)
title(main = symbol,col.main="blue",cex.main=4)
max.y <- max(foo$density)
A1 <- density(data[cells_1],adjust=2)
lines(A1$x,scales::rescale(A1$y, to=c(0,max.y)),col="indianred4",lwd=4)
A2 <- density(data[cells_2],adjust=2)
max.y <- max(A$y)
lines(A2$x,scales::rescale(A2$y, to=c(0,2*max.y)), col="mediumorchid4",lwd=4)
abline(v=cutoff_tmp, col=c("red"), lty=2)
lines(A2$x,scales::rescale(A2$y, to=c(0,max.y)), col="mediumorchid4",lwd=4)
data <- RNAseq_CTRPv2_All_CCLE[,control[2]][!is.na(RNAseq_CTRPv2_All_CCLE[,control[2]])]
if(var(data)==0){
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
rr2 <- mclust::Mclust(data = data, modelNames="V", G=2)
if(is.null(rr2[[1]])) { ## EM algorithm did not converge
message("didn't converage")
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
cells_1 <- names(rr2$classification)[rr2$classification==1]
cells_2 <- names(rr2$classification)[rr2$classification==2]
cutoff_tmp <- mean(c(min(data[cells_2]), max(data[cells_1])))
cutoffs <- c(cutoffs,cutoff_tmp)
symbol <- names(control)[2]
A1 <- density(data[cells_1],adjust=2)
max.y_tmp <- max(A1$y)
A <- density(data)
max.y <- max(A$y)
par(lwd = 4)
foo <- hist(data,breaks = 50,freq = F,axes = F, ylab = NULL, xlab = NULL,col = "lightgray", main = NULL,cex=2, xaxt='n',ann=FALSE)
max.y <- max(foo$density)
#  axis(side = 2, lwd = 4,ann=FALSE)
title(main = symbol,col.main="blue",cex.main=4)
max.y <- max(foo$density)
A1 <- density(data[cells_1],adjust=2)
lines(A1$x,scales::rescale(A1$y, to=c(0,max.y)),col="indianred4",lwd=4)
A2 <- density(data[cells_2],adjust=2)
max.y <- max(A$y)
lines(A2$x,scales::rescale(A2$y, to=c(0,max.y)), col="mediumorchid4",lwd=4)
abline(v=cutoff_tmp, col=c("red"), lty=2)
gene <- control[2]
data <- RNAseq_CTRPv2_All_CCLE[,gene][!is.na(RNAseq_CTRPv2_All_CCLE[,gene])]
if(var(data)==0){
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
rr2 <- mclust::Mclust(data = data, modelNames="V", G=2)
if(is.null(rr2[[1]])) { ## EM algorithm did not converge
message("didn't converage")
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
cells_1 <- names(rr2$classification)[rr2$classification==1]
cells_2 <- names(rr2$classification)[rr2$classification==2]
cutoff_tmp <- mean(c(min(data[cells_2]), max(data[cells_1])))
cutoffs <- c(cutoffs,cutoff_tmp)
symbol <- names(control)[2]
A1 <- density(data[cells_1],adjust=2)
max.y_tmp <- max(A1$y)
A <- density(data)
max.y <- max(A$y)
par(lwd = 4)
foo <- hist(data,breaks = 50,freq = F,axes = F, ylab = NULL, xlab = NULL,col = "lightgray", main = NULL,cex=2, xaxt='n',ann=FALSE)
max.y <- max(foo$density)
#  axis(side = 2, lwd = 4,ann=FALSE)
title(main = symbol,col.main="blue",cex.main=4)
max.y <- max(foo$density)
A1 <- density(data[cells_1],adjust=2)
lines(A1$x,scales::rescale(A1$y, to=c(0,max.y)),col="indianred4",lwd=4)
A2 <- density(data[cells_2],adjust=2)
max.y <- max(A$y)
lines(A2$x,scales::rescale(A2$y, to=c(0,max.y)), col="mediumorchid4",lwd=4)
abline(v=cutoff_tmp, col=c("red"), lty=2)
gene <- "ENSG00000182195"
data <- RNAseq_CTRPv2_All_CCLE[,gene][!is.na(RNAseq_CTRPv2_All_CCLE[,gene])]
if(var(data)==0){
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
rr2 <- mclust::Mclust(data = data, modelNames="V", G=2)
if(is.null(rr2[[1]])) { ## EM algorithm did not converge
message("didn't converage")
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
cells_1 <- names(rr2$classification)[rr2$classification==1]
cells_2 <- names(rr2$classification)[rr2$classification==2]
cutoff_tmp <- mean(c(min(data[cells_2]), max(data[cells_1])))
cutoffs <- c(cutoffs,cutoff_tmp)
symbol <- names(control)[2]
A1 <- density(data[cells_1],adjust=2)
max.y_tmp <- max(A1$y)
A <- density(data)
max.y <- max(A$y)
par(lwd = 4)
foo <- hist(data,breaks = 50,freq = F,axes = F, ylab = NULL, xlab = NULL,col = "lightgray", main = NULL,cex=2, xaxt='n',ann=FALSE)
max.y <- max(foo$density)
#  axis(side = 2, lwd = 4,ann=FALSE)
title(main = symbol,col.main="blue",cex.main=4)
max.y <- max(foo$density)
A1 <- density(data[cells_1],adjust=2)
lines(A1$x,scales::rescale(A1$y, to=c(0,max.y)),col="indianred4",lwd=4)
A2 <- density(data[cells_2],adjust=2)
max.y <- max(A$y)
lines(A2$x,scales::rescale(A2$y, to=c(0,max.y)), col="mediumorchid4",lwd=4)
abline(v=cutoff_tmp, col=c("red"), lty=2)
RNAseq_CTRPv2_All_CCLE <- t(exprs(summarizeMolecularProfiles(CTRPv2.CCLE,mDataType = "rna",fill.missing = F)))
data <- RNAseq_CTRPv2_All_CCLE[,gene][!is.na(RNAseq_CTRPv2_All_CCLE[,gene])]
if(var(data)==0){
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
rr2 <- mclust::Mclust(data = data, modelNames="V", G=2)
if(is.null(rr2[[1]])) { ## EM algorithm did not converge
message("didn't converage")
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
cells_1 <- names(rr2$classification)[rr2$classification==1]
cells_2 <- names(rr2$classification)[rr2$classification==2]
cutoff_tmp <- mean(c(min(data[cells_2]), max(data[cells_1])))
cutoffs <- c(cutoffs,cutoff_tmp)
symbol <- names(control)[2]
A1 <- density(data[cells_1],adjust=2)
max.y_tmp <- max(A1$y)
A <- density(data)
max.y <- max(A$y)
par(lwd = 4)
foo <- hist(data,breaks = 50,freq = F,axes = F, ylab = NULL, xlab = NULL,col = "lightgray", main = NULL,cex=2, xaxt='n',ann=FALSE)
max.y <- max(foo$density)
#  axis(side = 2, lwd = 4,ann=FALSE)
title(main = symbol,col.main="blue",cex.main=4)
max.y <- max(foo$density)
A1 <- density(data[cells_1],adjust=2)
lines(A1$x,scales::rescale(A1$y, to=c(0,max.y)),col="indianred4",lwd=4)
A2 <- density(data[cells_2],adjust=2)
max.y <- max(A$y)
lines(A2$x,scales::rescale(A2$y, to=c(0,max.y)), col="mediumorchid4",lwd=4)
abline(v=cutoff_tmp, col=c("red"), lty=2)
gene <- "ENSG00000182195_at"
data <- RNAseq_CTRPv2_All_CCLE[,gene][!is.na(RNAseq_CTRPv2_All_CCLE[,gene])]
if(var(data)==0){
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
rr2 <- mclust::Mclust(data = data, modelNames="V", G=2)
if(is.null(rr2[[1]])) { ## EM algorithm did not converge
message("didn't converage")
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
cells_1 <- names(rr2$classification)[rr2$classification==1]
cells_2 <- names(rr2$classification)[rr2$classification==2]
cutoff_tmp <- mean(c(min(data[cells_2]), max(data[cells_1])))
cutoffs <- c(cutoffs,cutoff_tmp)
symbol <- names(control)[2]
A1 <- density(data[cells_1],adjust=2)
max.y_tmp <- max(A1$y)
A <- density(data)
max.y <- max(A$y)
par(lwd = 4)
foo <- hist(data,breaks = 50,freq = F,axes = F, ylab = NULL, xlab = NULL,col = "lightgray", main = NULL,cex=2, xaxt='n',ann=FALSE)
max.y <- max(foo$density)
#  axis(side = 2, lwd = 4,ann=FALSE)
title(main = symbol,col.main="blue",cex.main=4)
max.y <- max(foo$density)
A1 <- density(data[cells_1],adjust=2)
lines(A1$x,scales::rescale(A1$y, to=c(0,max.y)),col="indianred4",lwd=4)
A2 <- density(data[cells_2],adjust=2)
max.y <- max(A$y)
lines(A2$x,scales::rescale(A2$y, to=c(0,max.y)), col="mediumorchid4",lwd=4)
abline(v=cutoff_tmp, col=c("red"), lty=2)
data <- RNAseq_CTRPv2_All_CCLE[,gene][!is.na(RNAseq_CTRPv2_All_CCLE[,gene])]
if(var(data)==0){
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
rr2 <- mclust::Mclust(data = data, modelNames="V", G=2)
if(is.null(rr2[[1]])) { ## EM algorithm did not converge
message("didn't converage")
cutoffs <- c(cutoffs,max(data,na.rm = T))
next
}
cells_1 <- names(rr2$classification)[rr2$classification==1]
cells_2 <- names(rr2$classification)[rr2$classification==2]
cutoff_tmp <- mean(c(min(data[cells_2]), max(data[cells_1])))
#cutoffs <- c(cutoffs,cutoff_tmp)
symbol <- names(control)[2]
A1 <- density(data[cells_1],adjust=2)
max.y_tmp <- max(A1$y)
A <- density(data)
max.y <- max(A$y)
par(lwd = 4)
foo <- hist(data,breaks = 50,freq = F,axes = F, ylab = NULL, xlab = NULL,col = "lightgray", main = NULL,cex=2, xaxt='n',ann=FALSE)
max.y <- max(foo$density)
#  axis(side = 2, lwd = 4,ann=FALSE)
title(main = symbol,col.main="blue",cex.main=4)
max.y <- max(foo$density)
A1 <- density(data[cells_1],adjust=2)
lines(A1$x,scales::rescale(A1$y, to=c(0,max.y)),col="indianred4",lwd=4)
A2 <- density(data[cells_2],adjust=2)
max.y <- max(A$y)
lines(A2$x,scales::rescale(A2$y, to=c(0,max.y)), col="mediumorchid4",lwd=4)
abline(v=cutoff_tmp, col=c("red"), lty=2)
library(PharmacoGx)
downloadPSet("CTRPv2")
CTRPv2 <- downloadPSet("CTRPv2")
A <- subsetTo(CTRPv2,drugs = c("fluvastatin","lovastatin"))
A <- subsetTo(CTRPv2,drugs = c("fluvastatin"))
drugNames(CTRPv2) <- gsub(drugNames(CTRPv2), pattern="N-{3-Chloro-4-[(3-fluorobenzyl)oxy]phenyl}-6-[5-({[2-(methylsulfonyl)ethyl]amino}methyl)-2-furyl]-4-quinazolinamine", replacement="lapatinib", fixed=TRUE)
rownames(CTRPv2@curation$tissue) <- rownames(CTRPv2@curation$cell)
CTRPv2@curation$tissue[!is.na(CTRPv2@curation$tissue[ , "unique.tissueid"]) & CTRPv2@curation$tissue[ , "unique.tissueid"] == "", "unique.tissueid"] <- NA
cellInfo(CTRPv2)[!is.na(cellInfo(CTRPv2)[ , "tissueid"]) & cellInfo(CTRPv2)[ , "tissueid"] == "", "tissueid"] <- NA
A <- subsetTo(CTRPv2,drugs = c("fluvastatin"))
A
A <- subsetTo(CTRPv2,drugs = c("fluvastatin","lovastatin"))
A
load("~/Projects/PSets/PSets/CCLE.rdata")
A <- intersectPSet(c(CTRPv2,CCLE))
CCLE@molecularProfiles$rnaseq
class(CCLE@molecularProfiles$rnaseq)
load("~/Projects/PSets/PSets/CTRPv2.RData")
checkPSetStructure(CTRPv2)
A <- subsetTo(CTRPv2,drugs = c("fluvastatin","lovastatin"))
A
CTRPv2@drug["lapatinib",]
grep("lapatinip",drugNames(CTRPv2))
grep("lapatinib",drugNames(CTRPv2))
featureInfo(CCLE,"rnaseq")
A <- CCLE@molecularProfiles$rnaseq
pData(A)
library(Biobase)
pData(A)
head(pData(A))
?pData
install.packages("CCA")
load("~/Projects/PSets/PSets/UHN_kallisto.RData")
UHN@molecularProfiles
load("~/Projects/PSets/PSets/UHNBreast.RData")
UHNBreast@molecularProfiles
load("~/Projects/PSets/PSets/UHN.rdata")
UHN@molecularProfiles
load("~/Projects/PSets/PSets/UHN_hs.RData")
require(Biobase)
require(PharmacoGx)
require(ggplot2)
require(gplots)
require(gridExtra)
require(piano)
setwd("~/Projects/SU2C/SU2C_biomarkers_analysis/2257_story/KelsiePaper/CFI402257/")
setwd("~/Projects/SU2C/SU2C_biomarkers_analysis/2257_story/KelsiePaper/resistance_to_TTK_inhib/CFI402257/")
UHNBreast <- readRDS("DATA/UHNBreast.rda")
UHNBreast <- readRDS("../UHNBreast.rda")
rnaSeq_BC <- t(exprs(summarizeMolecularProfiles(UHNBreast,mDataType = "rnaseq",fill.missing = F)))
AUCs <- summarizeSensitivityProfiles(UHNBreast,sensitivity.measure = "AUC",fill.missing = F)
rnaSeq_BC <- rnaSeq_BC[names(AUCs),]
drug <- "2257"
drug_assoc <- PharmacoGx:::rankGeneDrugSensitivity(data = rnaSeq_BC,drugpheno = AUCs,single.type = T,nthread = 4)
require(PharmacoGx)
library(PharmacoGx)
drug_assoc <- PharmacoGx:::rankGeneDrugSensitivity(data = rnaSeq_BC,drugpheno = AUCs,single.type = T,nthread = 4)
sessionInfo()
